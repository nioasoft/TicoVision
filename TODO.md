# 📋 רשימת משימות TicoVision AI

**תאריך עדכון אחרון**: דצמבר 2024  
**דדליין קריטי**: 25 בדצמבר 2025 - מכתבי שכ"ט חייבים לצאת אוטומטית

---

## 🚨 משימות דחופות - לביצוע מיידי

### 🗄️ תשתית Database (חובה לפני כל דבר אחר)
- [x] יצירת סכמת DB מלאה בSupabase ✅ (דצמבר 2024)
  - [x] טבלת tenants עם white-label support ✅
  - [x] טבלת clients עם ולידציית ת.ז ישראלית ✅
  - [x] טבלת fee_calculations עם partitioning ✅
  - [x] טבלת letter_templates (11 תבניות) ✅
  - [x] טבלת payment_transactions ✅
  - [x] טבלת audit_logs ✅
  - [x] טבלת job_queue ✅
- [x] הגדרת RLS Policies לבידוד tenants ✅
- [x] יצירת Functions וTriggers ✅
  - [x] get_current_tenant_id() ✅
  - [x] create_tenant_partition() ✅
  - [x] update_updated_at_column() ✅
- [x] יצירת Materialized Views לביצועים ✅
- [x] הגדרת Indexes לאופטימיזציה ✅
- [x] **הרצת migration בSupabase** ✅ (דצמבר 2024)

### 🔧 תיקונים טכניים דחופים
- [x] תיקון חיבור Supabase MCP ✅ (דצמבר 2024)
- [x] סגירת dev servers ישנים ✅ (דצמבר 2024)
- [x] תיקון Multiple GoTrueClient instances ✅ (דצמבר 2024)
- [x] תיקון 400 error בfee_calculations ✅ (דצמבר 2024)
- [x] התקנת חבילות חסרות (SendGrid, BullMQ, Upstash) ✅ (דצמבר 2024)
- [x] הגדרת משתני סביבה חסרים ✅ (דצמבר 2024)

---

## 📅 Sprint 1: תשתית ומשתמשים (שבועות 1-2)

### שבוע 1: Database Foundation
- [x] יצירת migrations לכל הטבלאות ✅ (דצמבר 2024)
- [x] בדיקת חיבור Supabase ✅ (דצמבר 2024)
- [ ] יצירת seed data לפיתוח
- [x] בדיקת RLS policies ✅ (דצמבר 2024)
- [ ] תיעוד סכמת DB

### שבוע 2: User Management
- [ ] מערכת 4 תפקידים (admin, accountant, bookkeeper, client)
- [ ] דף /admin/users - ניהול משתמשים
- [ ] מנגנון אישור משתמשים חדשים
- [ ] דף /admin/permissions - ניהול הרשאות
- [ ] דף /admin/audit-logs - לוג פעולות
- [ ] בדיקות הרשאות מקיפות

---

## 📅 Sprint 2: ניהול לקוחות (שבועות 3-4)

### שבוע 3: Client Management
- [ ] דף /clients - רשימת לקוחות
  - [ ] טבלה עם pagination
  - [ ] חיפוש דינמי
  - [ ] פילטרים מרובים
  - [ ] ייצוא לExcel
- [ ] טופס הוספת לקוח חדש
  - [ ] ולידציית ת.ז (9 ספרות)
  - [ ] שדות חובה/רשות
  - [ ] שמירה בDB
- [ ] דף לקוח בודד
  - [ ] צפייה בפרטים
  - [ ] עריכה
  - [ ] היסטוריה

### שבוע 4: Client Groups & Import
- [ ] ניהול קבוצות לקוחות (רשתות)
- [ ] ייבוא נתונים מMonday.com
- [ ] ייבוא מExcel
- [ ] ולידציית נתונים מיובאים
- [ ] דוח ייבוא

---

## 📅 Sprint 3: מערכת שכר טרחה (שבועות 5-6)

### שבוע 5: Fee Calculations
- [ ] מסך חישוב שכ"ט
  - [ ] כרטיסיית נתוני שנה קודמת
  - [ ] כרטיסיית חישוב שנה נוכחית
  - [ ] חישובי מדד אוטומטיים (3%)
  - [ ] תוספות ריאליות
  - [ ] חישוב מע"מ (18%)
- [ ] לוגיקת חישובים מורכבת
- [ ] שמירת חישובים בDB
- [ ] היסטוריית שינויים

### שבוע 6: Fee Tracking
- [ ] מעקב סטטוס תשלום
- [ ] דוחות גביה
- [ ] התראות על חובות
- [ ] ניתוח מגמות תשלום
- [ ] דשבורד גביה

---

## 📅 Sprint 4: מערכת מכתבים (שבועות 7-8)

### שבוע 7: Letter Templates
- [x] **🚨 איסוף 11 תבניות משני ותיקו** ✅ (דצמבר 2024 - קיימות בתיקייה)
- [ ] הטמעת תבניות במערכת
- [ ] מנוע החלפת משתנים
  - [ ] {{client_name}}
  - [ ] {{amount}}
  - [ ] {{due_date}}
  - [ ] {{payment_link}}
- [ ] לוגיקת בחירת תבנית

### שבוע 8: Letter Generation
- [ ] ממשק יצירת מכתבים
- [ ] תצוגה מקדימה
- [ ] שליחה במייל (SendGrid)
- [ ] היסטוריית מכתבים
- [ ] מעקב תגובות

---

## 📅 Sprint 5: אינטגרציית Cardcom (שבועות 9-10)

### שבוע 9: Payment Integration
- [x] **🚨 קבלת פרטי API מטיקו** ✅ (דצמבר 2024 - משתמשים בדמו)
- [ ] Low Profile Integration
- [ ] יצירת קישורי תשלום
- [ ] הטמעה במכתבים
- [ ] דף תשלום

### שבוע 10: Payment Tracking
- [ ] Webhook handler
- [ ] עדכוני סטטוס אוטומטיים
- [ ] יצירת קבלות
- [ ] דוחות תשלומים
- [ ] ניתוח נתוני גביה

---

## 📅 Sprint 6: דשבורד ודוחות (שבועות 11-12)

### שבוע 11: Dashboard
- [ ] דשבורד ראשי
  - [ ] הכנסות real-time
  - [ ] תקציב מול ביצוע
  - [ ] סטטוס גביה
  - [ ] KPIs
- [ ] גרפים (Recharts)
- [ ] ויזואליזציות

### שבוע 12: Reports & Testing
- [ ] דוחות ניהוליים
- [ ] דוחות גביה
- [ ] בדיקות מקיפות
- [ ] תיקון באגים
- [ ] הכנה לproduction

---

## 🔄 משימות שוטפות

### תיעוד
- [x] עדכון CLAUDE.md ✅ (דצמבר 2024)
- [ ] תיעוד API
- [ ] מדריך משתמש
- [ ] תיעוד טכני

### בדיקות
- [ ] Unit tests (Vitest)
- [ ] E2E tests (Playwright)
- [ ] בדיקות RTL/עברית
- [ ] בדיקות ביצועים

### DevOps
- [ ] CI/CD pipeline
- [ ] Monitoring (Sentry)
- [ ] Backups
- [ ] Security audit
- [x] Recharts installed ✅ (דצמבר 2024)

---

## 📝 הערות חשובות

### חסמים קריטיים:
1. **תבניות מכתבים** - חייב לקבל משני ותיקו דחוף!
2. **פרטי Cardcom** - חייב לקבל מטיקו דחוף!
3. **נתוני Monday.com** - צריך גישה לייצוא

### נקודות החלטה:
- [ ] צבעים ועיצוב (יפעת)
- [ ] הודעת חזון לדף הבית
- [ ] כללי עסקיים (אחוזי מדד, הנחות)

### לתיאום:
- [ ] הדרכת משתמשים (טיקו + שני)
- [ ] בדיקות קבלה
- [ ] הגדרת תהליכים

---

## ✅ משימות שהושלמו

### תשתית בסיסית
- [x] הקמת פרויקט React + Vite + TypeScript ✅
- [x] התקנת shadcn/ui ✅
- [x] הגדרת RTL ועברית ✅
- [x] יצירת services בסיסיים ✅
- [x] יצירת דפים ראשיים ✅
- [x] AuthContext עם Supabase ✅
- [x] התקנת Recharts לגרפים ✅ (דצמבר 2024)

### ישראליזציה
- [x] תמיכה בRTL ✅
- [x] פונטים עבריים ✅
- [x] ולידציית ת.ז ישראלית ✅
- [x] פורמט תאריך DD/MM/YYYY ✅
- [x] פורמט מטבע ₪ ✅
- [x] עדכון מע"מ ל-18% ✅ (דצמבר 2024)

---

**עדכון אחרון**: דצמבר 2024  
**מעקב יומי**: כל משימה שמסתיימת מסומנת ב-✅ עם תאריך