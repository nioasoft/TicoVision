# ✅ רשימת בדיקות למסוף Cardcom - לטיקו

## 🎯 מטרה
לוודא שהמסוף **172012** מוגדר נכון לעבודה עם API של פרופיל נמוך (Low Profile).

---

## 📋 רשימת בדיקות

### 1️⃣ **כניסה למסוף Cardcom**
- [ ] כניסה ל: https://secure.cardcom.solutions
- [ ] מספר מסוף: **172012**
- [ ] שם משתמש: (השם משתמש שלך לכניסה למסוף)
- [ ] סיסמה: (הסיסמה שלך)

---

### 2️⃣ **בדיקת הפעלת מודול Low Profile**

#### דרך 1: הגדרות כלליות
1. היכנס ל: **הגדרות → 4. סליקה בפרופיל נמוך**
2. ודא שהמודול **מופעל** ✅
3. אם לא - פנה לתמיכת Cardcom להפעלה: **03-9436100**

#### דרך 2: בדיקה ישירה
1. נסה להיכנס ל: https://secure.cardcom.solutions/Definition/LowProfile/GlobalDef.aspx
2. אם אתה רואה דף הגדרות = **המודול מופעל** ✅
3. אם אתה מקבל שגיאה = **המודול לא מופעל** ❌

---

### 3️⃣ **בדיקת פרטי API** ⭐ **החשוב ביותר!**

#### היכנס ל: **הגדרות → מידע למפתח**
או ישירות ל: https://secure.cardcom.solutions/Definition/LowProfile/api.aspx

**🔍 בדוק מה כתוב שם בדיוק:**

לפי התיעוד הרשמי, צריך להיות רשום:
- [ ] **TerminalNumber**: `172012` (מספר מסוף)
- [ ] **ApiName**: `XXXXXXX` (שם משתמש ל-API)

**⚠️ שים לב:**
- ה-**ApiName** הוא **לא** שם המשתמש לכניסה למסוף!
- זה שם משתמש **ייעודי ל-API** בלבד
- בדרך כלל נראה כמו: `test2025` (לסביבת Test) או משהו דומה

**❓ שאלות חשובות:**
1. האם יש בכלל שדה **ApiName** או **API Username**?
2. אם כן - מה כתוב שם?
3. האם `iiaaeXCo5eyRyZrDYOIj` הוא שם המשתמש **לכניסה למסוף** או **ל-API**?

---

### 4️⃣ **בדיקת Indicator URL (Webhook)**

#### היכנס ל: **הגדרות → 4. סליקה בפרופיל נמוך**

הגדר את ה-Webhook URL:
```
https://zbqfeebrhberddvfkuhe.supabase.co/functions/v1/cardcom-webhook
```

**חשוב:**
- [ ] ודא שה-URL נשמר נכון
- [ ] בדוק שאין שגיאות באדום

---

### 5️⃣ **בדיקת הרשאות API**

#### היכנס ל: **הגדרות → הרשאות משתמשים**

ודא שהמשתמש `iiaaeXCo5eyRyZrDYOIj` או המסוף 172012 יש לו הרשאות:
- [ ] ✅ **Low Profile** - הרשאת שימוש
- [ ] ✅ **Create Invoice** - יצירת חשבוניות (אם רלוונטי)
- [ ] ✅ **API Access** - גישה ל-API

---

### 6️⃣ **בדיקת סטטוס המסוף**

#### היכנס ל: **לוח הבקרה** (Dashboard)

ודא שמסוף **172012**:
- [ ] ✅ **פעיל** (Active)
- [ ] ✅ לא חסום
- [ ] ✅ אין הודעות שגיאה

---

### 7️⃣ **בדיקת IP Whitelisting (אם יש חומת אש)**

אם יש חומת אש במסוף Cardcom:

#### היכנס ל: **הגדרות → אבטחה → IP Allowed List**

ודא שהכתובות IP הבאות **לא חסומות**:
- Supabase IP ranges
- כתובת IP של המשרד שלך (אופציונלי)

**אם לא בטוח - פשוט אל תגדיר הגבלת IP.**

---

## 🧪 בדיקה ידנית - נסה ליצור Low Profile Code

### דרך הממשק הגרפי:
1. היכנס ל: **סליקה → פרופיל נמוך → צור עסקה חדשה**
2. מלא פרטים:
   - סכום: 100 ₪
   - תיאור: "בדיקה"
3. לחץ **צור לינק תשלום**
4. אם זה עובד = **המסוף תקין** ✅
5. אם זה נכשל = **יש בעיה במסוף** ❌

---

## 📧 מה לשלוח לתמיכת Cardcom (אם צריך)

אם משהו לא עובד, פנה לתמיכה:

**אימייל:** support@cardcom.co.il
**טלפון:** 03-9436100

**תוכן המייל:**
```
נושא: בקשה להפעלת מודול Low Profile - מסוף 172012

שלום,

אנחנו מנסים לעבוד עם API של פרופיל נמוך (Low Profile) למסוף 172012.

מקבלים שגיאה: ResponseCode=9999 - "Unknown error"

בדקנו:
✅ Terminal Number: 172012
✅ API Username: iiaaeXCo5eyRyZrDYOIj

נבקש לבדוק:
1. האם מודול Low Profile מופעל במסוף?
2. האם יש הרשאות API למשתמש?
3. האם המסוף פעיל?

תודה!
```

---

## 🎯 הצעד הבא

אחרי שטיקו יבדוק את כל הנקודות למעלה, נריץ שוב את הבדיקה:

```bash
npx tsx scripts/test-cardcom-credentials.ts
```

אם זה עובד - נמשיך לשלב הבא (שליחת מכתבים עם לינקים אמיתיים)!

---

## 📞 צור קשר

יש בעיה? אני כאן לעזור! 🚀
