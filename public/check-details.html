<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title id="page-title">×¤×¨×˜×™ ×ª×©×œ×•× ×‘×”××—××•×ª</title>
    <style>
        @media print {
            body {
                margin: 0;
                padding: 20px;
            }
            .no-print {
                display: none;
            }
        }
    </style>
</head>
<body style="margin: 0; padding: 20px; font-family: 'Heebo', 'Assistant', Arial, sans-serif; background-color: hsl(210 40% 96.1%); direction: rtl;">
    <!-- Main container table (Card style) -->
    <table width="700" cellpadding="0" cellspacing="0" border="0" style="margin: 0 auto; background-color: #ffffff; border-radius: 8px; border: 1px solid hsl(214.3 31.8% 91.4%); box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px -1px rgba(0, 0, 0, 0.1); font-family: 'Heebo', 'Assistant', Arial, sans-serif;">

        <!-- Header: Logo centered on top -->
        <tr>
            <td style="padding: 40px 40px 20px 40px; text-align: center;">
                <img src="https://ticovision.vercel.app/brand/tico_logo_transparent.png" width="90" height="40" alt="TICO" style="display: inline-block; border: 0;">
            </td>
        </tr>

        <!-- Recipient Info -->
        <tr>
            <td style="padding: 0 40px 20px 40px;">
                <div style="font-size: 13px; line-height: 1.6; font-weight: 600; color: hsl(222.2 84% 4.9%); text-align: right;">
                    ×œ×›×‘×•×“:<br>
                    <span class="company-name">××¡×¢×“×ª ×”××—×™×<br>×§×‘×•×¦×ª ××¡×¢×“×•×ª ×™×©×¨××œ×™×•×ª</span>
                </div>
            </td>
        </tr>

        <!-- Top border -->
        <tr>
            <td style="padding: 0 40px 20px 40px;">
                <div style="border-top: 1px solid hsl(214.3 31.8% 91.4%);"></div>
            </td>
        </tr>

        <!-- Title -->
        <tr>
            <td style="padding: 0 40px 24px 40px;">
                <div id="main-title" style="font-size: 18px; line-height: 1.4; font-weight: 600; color: hsl(222.2 84% 4.9%); text-align: center;">
                    ×¤×¨×˜×™ ×ª×©×œ×•× ×‘-8 ×”××—××•×ª
                </div>
            </td>
        </tr>

        <!-- Payment Details -->
        <tr>
            <td style="padding: 0 40px 24px 40px;">
                <div style="font-size: 14px; line-height: 1.5; font-weight: 600; color: hsl(222.2 84% 4.9%); text-align: right; margin-bottom: 16px;">
                    ××•×¤×Ÿ ×”×ª×©×œ×•×:
                </div>
                <div style="font-size: 13px; line-height: 1.7; color: hsl(222.2 84% 4.9%); text-align: right;">
                    <table cellpadding="0" cellspacing="0" border="0" style="width: 100%;">
                        <tr>
                            <td style="width: 20px; vertical-align: top; padding-top: 4px;">
                                <img src="https://ticovision.vercel.app/brand/bullet-star.png" width="9" height="9" alt="â€¢" style="display: block; border: 0;">
                            </td>
                            <td style="padding-bottom: 12px;" class="check-description">
                                × ×•×“×”, ××™×¤×”, ×¢×œ ×”×›× ×ª 8 ×”××—××•×ª ×©×¡×›×•× ×›×œ ××—×ª ××”×Ÿ (×”×¡×›×•× ×›×‘×¨ ×›×•×œ×œ ××¢"×) ×”×™× ×• ×‘×¡×”"×› ×©×œ: <span style="text-decoration: underline; font-weight: 600;">â‚ª5,900</span>.
                            </td>
                        </tr>
                        <tr>
                            <td style="width: 20px; vertical-align: top; padding-top: 4px;">
                                <img src="https://ticovision.vercel.app/brand/bullet-star.png" width="9" height="9" alt="â€¢" style="display: block; border: 0;">
                            </td>
                            <td style="padding-bottom: 12px;">
                                ×ª××¨×™×›×™ ×”×”××—××•×ª ×”×™× × ×œ×—××™×©×™ ×œ×›×œ ×—×•×“×©, ×”×—×œ ××™×•× 5.1.2025 ×•×¢×“ ×œ×™×•× 5.8.2025.
                            </td>
                        </tr>
                        <tr>
                            <td style="width: 20px; vertical-align: top; padding-top: 4px;">
                                <img src="https://ticovision.vercel.app/brand/bullet-star.png" width="9" height="9" alt="â€¢" style="display: block; border: 0;">
                            </td>
                            <td style="padding-bottom: 12px;">
                                × ×‘×§×©×›× ×‘×›×œ ×œ×©×•×Ÿ ×œ×”×§×¤×™×“ ×¢×œ ×ª××¨×™×›×™ ×”×”××—××•×ª ×•×”×¡×›×•××™× ×”××“×•×™×§×™×.
                            </td>
                        </tr>
                        <tr>
                            <td style="width: 20px; vertical-align: top; padding-top: 4px;">
                                <img src="https://ticovision.vercel.app/brand/bullet-star.png" width="9" height="9" alt="â€¢" style="display: block; border: 0;">
                            </td>
                            <td class="check-calculation">
                                <strong>×¡×›×•× ×›×•×œ×œ ×œ×ª×©×œ×•×: â‚ª47,200</strong> (8 ×”××—××•×ª Ã— â‚ª5,900)
                            </td>
                        </tr>
                    </table>
                </div>
            </td>
        </tr>

        <!-- Check Schedule Table -->
        <tr>
            <td style="padding: 0 40px 32px 40px;">
                <div style="font-size: 14px; line-height: 1.5; font-weight: 600; color: hsl(222.2 84% 4.9%); text-align: right; margin-bottom: 12px;">
                    ×œ×•×— ×ª×©×œ×•××™×:
                </div>
                <table width="100%" cellpadding="0" cellspacing="0" border="0" style="border: 1px solid hsl(214.3 31.8% 91.4%); border-radius: 6px; overflow: hidden;">
                    <!-- Table Header -->
                    <tr style="background-color: hsl(210 40% 96.1%);">
                        <th style="padding: 12px; text-align: right; font-size: 13px; font-weight: 600; color: hsl(222.2 84% 4.9%); border-bottom: 1px solid hsl(214.3 31.8% 91.4%);">××¡×¤×¨ ×”××—××”</th>
                        <th style="padding: 12px; text-align: right; font-size: 13px; font-weight: 600; color: hsl(222.2 84% 4.9%); border-bottom: 1px solid hsl(214.3 31.8% 91.4%);">×ª××¨×™×š</th>
                        <th style="padding: 12px; text-align: right; font-size: 13px; font-weight: 600; color: hsl(222.2 84% 4.9%); border-bottom: 1px solid hsl(214.3 31.8% 91.4%);">×¡×›×•×</th>
                    </tr>
                    <!-- Check 1 -->
                    <tr>
                        <td style="padding: 10px 12px; text-align: right; font-size: 13px; color: hsl(222.2 84% 4.9%); border-bottom: 1px solid hsl(214.3 31.8% 91.4%);">1</td>
                        <td style="padding: 10px 12px; text-align: right; font-size: 13px; color: hsl(222.2 84% 4.9%); border-bottom: 1px solid hsl(214.3 31.8% 91.4%);">5.1.2026</td>
                        <td style="padding: 10px 12px; text-align: right; font-size: 13px; font-weight: 600; color: hsl(222.2 84% 4.9%); border-bottom: 1px solid hsl(214.3 31.8% 91.4%);" class="check-amount">â‚ª5,900</td>
                    </tr>
                    <!-- Check 2 -->
                    <tr>
                        <td style="padding: 10px 12px; text-align: right; font-size: 13px; color: hsl(222.2 84% 4.9%); border-bottom: 1px solid hsl(214.3 31.8% 91.4%);">2</td>
                        <td style="padding: 10px 12px; text-align: right; font-size: 13px; color: hsl(222.2 84% 4.9%); border-bottom: 1px solid hsl(214.3 31.8% 91.4%);">5.2.2026</td>
                        <td style="padding: 10px 12px; text-align: right; font-size: 13px; font-weight: 600; color: hsl(222.2 84% 4.9%); border-bottom: 1px solid hsl(214.3 31.8% 91.4%);" class="check-amount">â‚ª5,900</td>
                    </tr>
                    <!-- Check 3 -->
                    <tr>
                        <td style="padding: 10px 12px; text-align: right; font-size: 13px; color: hsl(222.2 84% 4.9%); border-bottom: 1px solid hsl(214.3 31.8% 91.4%);">3</td>
                        <td style="padding: 10px 12px; text-align: right; font-size: 13px; color: hsl(222.2 84% 4.9%); border-bottom: 1px solid hsl(214.3 31.8% 91.4%);">5.3.2026</td>
                        <td style="padding: 10px 12px; text-align: right; font-size: 13px; font-weight: 600; color: hsl(222.2 84% 4.9%); border-bottom: 1px solid hsl(214.3 31.8% 91.4%);" class="check-amount">â‚ª5,900</td>
                    </tr>
                    <!-- Check 4 -->
                    <tr>
                        <td style="padding: 10px 12px; text-align: right; font-size: 13px; color: hsl(222.2 84% 4.9%); border-bottom: 1px solid hsl(214.3 31.8% 91.4%);">4</td>
                        <td style="padding: 10px 12px; text-align: right; font-size: 13px; color: hsl(222.2 84% 4.9%); border-bottom: 1px solid hsl(214.3 31.8% 91.4%);">5.4.2026</td>
                        <td style="padding: 10px 12px; text-align: right; font-size: 13px; font-weight: 600; color: hsl(222.2 84% 4.9%); border-bottom: 1px solid hsl(214.3 31.8% 91.4%);" class="check-amount">â‚ª5,900</td>
                    </tr>
                    <!-- Check 5 -->
                    <tr>
                        <td style="padding: 10px 12px; text-align: right; font-size: 13px; color: hsl(222.2 84% 4.9%); border-bottom: 1px solid hsl(214.3 31.8% 91.4%);">5</td>
                        <td style="padding: 10px 12px; text-align: right; font-size: 13px; color: hsl(222.2 84% 4.9%); border-bottom: 1px solid hsl(214.3 31.8% 91.4%);">5.5.2026</td>
                        <td style="padding: 10px 12px; text-align: right; font-size: 13px; font-weight: 600; color: hsl(222.2 84% 4.9%); border-bottom: 1px solid hsl(214.3 31.8% 91.4%);" class="check-amount">â‚ª5,900</td>
                    </tr>
                    <!-- Check 6 -->
                    <tr>
                        <td style="padding: 10px 12px; text-align: right; font-size: 13px; color: hsl(222.2 84% 4.9%); border-bottom: 1px solid hsl(214.3 31.8% 91.4%);">6</td>
                        <td style="padding: 10px 12px; text-align: right; font-size: 13px; color: hsl(222.2 84% 4.9%); border-bottom: 1px solid hsl(214.3 31.8% 91.4%);">5.6.2026</td>
                        <td style="padding: 10px 12px; text-align: right; font-size: 13px; font-weight: 600; color: hsl(222.2 84% 4.9%); border-bottom: 1px solid hsl(214.3 31.8% 91.4%);" class="check-amount">â‚ª5,900</td>
                    </tr>
                    <!-- Check 7 -->
                    <tr>
                        <td style="padding: 10px 12px; text-align: right; font-size: 13px; color: hsl(222.2 84% 4.9%); border-bottom: 1px solid hsl(214.3 31.8% 91.4%);">7</td>
                        <td style="padding: 10px 12px; text-align: right; font-size: 13px; color: hsl(222.2 84% 4.9%); border-bottom: 1px solid hsl(214.3 31.8% 91.4%);">5.7.2026</td>
                        <td style="padding: 10px 12px; text-align: right; font-size: 13px; font-weight: 600; color: hsl(222.2 84% 4.9%); border-bottom: 1px solid hsl(214.3 31.8% 91.4%);" class="check-amount">â‚ª5,900</td>
                    </tr>
                    <!-- Check 8 -->
                    <tr>
                        <td style="padding: 10px 12px; text-align: right; font-size: 13px; color: hsl(222.2 84% 4.9%);">8</td>
                        <td style="padding: 10px 12px; text-align: right; font-size: 13px; color: hsl(222.2 84% 4.9%);">5.8.2026</td>
                        <td style="padding: 10px 12px; text-align: right; font-size: 13px; font-weight: 600; color: hsl(222.2 84% 4.9%);" class="check-amount">â‚ª5,900</td>
                    </tr>
                    <!-- Total Row -->
                    <tr style="background-color: hsl(210 40% 96.1%);">
                        <td colspan="2" style="padding: 12px; text-align: right; font-size: 14px; font-weight: 600; color: hsl(222.2 84% 4.9%); border-top: 2px solid hsl(214.3 31.8% 91.4%);">×¡×”"×› ×œ×ª×©×œ×•×:</td>
                        <td style="padding: 12px; text-align: right; font-size: 14px; font-weight: 700; color: hsl(222.2 84% 4.9%); border-top: 2px solid hsl(214.3 31.8% 91.4%);" class="total-amount">â‚ª47,200</td>
                    </tr>
                </table>
            </td>
        </tr>

        <!-- Important Note -->
        <tr>
            <td style="padding: 0 40px 32px 40px;">
                <div style="background-color: #f8fafc; border: 1px solid hsl(214.3 31.8% 91.4%); border-radius: 6px; padding: 16px;">
                    <div style="font-size: 13px; line-height: 1.6; color: hsl(222.2 84% 4.9%); text-align: right;">
                        <strong>×©×™××• ×œ×‘:</strong> × ×™×ª×Ÿ ×œ×—×¡×•×š ×¢×“ 8% ×‘×‘×—×™×¨×ª ×ª×©×œ×•× ××™×™×“×™ ×‘×›×¨×˜×™×¡ ××©×¨××™ ××• ×”×¢×‘×¨×” ×‘× ×§××™×ª. ×œ×¤×¨×˜×™× × ×•×¡×¤×™×, ×—×–×¨×• ×œ××›×ª×‘ ×”××§×•×¨×™ ××• ×¦×¨×• ×§×©×¨.
                    </div>
                </div>
            </td>
        </tr>

        <!-- Print Button (Hidden in print) -->
        <tr class="no-print">
            <td style="padding: 0 40px 32px 40px; text-align: center;">
                <button onclick="window.print()" style="background-color: hsl(222.2 84% 4.9%); color: #ffffff; font-size: 14px; font-weight: 600; padding: 12px 32px; border: 1px solid hsl(214.3 31.8% 91.4%); border-radius: 6px; cursor: pointer; font-family: 'Heebo', 'Assistant', Arial, sans-serif;">
                    ×”×“×¤×¡ ×“×£ ×–×”
                </button>
            </td>
        </tr>

        <!-- Footer Top Border -->
        <tr>
            <td style="padding: 0 40px 0 40px;">
                <div style="border-top: 2px solid hsl(214.3 31.8% 91.4%);"></div>
            </td>
        </tr>

        <!-- Footer Content -->
        <tr>
            <td style="padding: 24px 40px 40px 40px;">
                <table width="100%" cellpadding="0" cellspacing="0" border="0">
                    <tr>
                        <!-- Logo Column - 30% width, enlarged logo, aligned right -->
                        <td width="30%" style="vertical-align: top; text-align: right; padding-left: 0;">
                            <img src="https://ticovision.vercel.app/brand/franco-logo.png" width="100" height="70" alt="TICO FRANCO & CO" style="display: block; margin-left: auto; margin-right: 0; border: 0;">
                        </td>
                        <!-- Gap Column - 12% -->
                        <td width="12%" style="padding: 0;"></td>
                        <!-- Contact Details - 58% -->
                        <td width="58%" style="vertical-align: top; text-align: right;">
                            <table cellpadding="0" cellspacing="0" border="0" style="width: 100%;">
                                <tr>
                                    <td style="font-size: 11px; line-height: 1.8; color: hsl(215.4 16.3% 46.9%); padding-bottom: 4px;">
                                        <img src="https://ticovision.vercel.app/brand/icon-building.png" width="18" height="18" alt="ğŸ“" style="display: inline-block; vertical-align: middle; margin-left: 6px; border: 0;">
                                        ×©×“"×œ 3, ××’×“×œ ××œ×¨×•×‘ ×§×•××” ×¨××©×•× ×”, ×ª×œ ××‘×™×‘
                                    </td>
                                </tr>
                                <tr>
                                    <td style="font-size: 11px; line-height: 1.8; color: hsl(215.4 16.3% 46.9%); padding-bottom: 4px;">
                                        <img src="https://ticovision.vercel.app/brand/icon-phone.png" width="18" height="18" alt="ğŸ“" style="display: inline-block; vertical-align: middle; margin-left: 6px; border: 0;">
                                        03-5666170
                                    </td>
                                </tr>
                                <tr>
                                    <td style="font-size: 11px; line-height: 1.8; color: hsl(215.4 16.3% 46.9%);">
                                        <img src="https://ticovision.vercel.app/brand/icon-email.png" width="18" height="14" alt="ğŸ“§" style="display: inline-block; vertical-align: middle; margin-left: 6px; border: 0;">
                                        tico@franco.co.il
                                    </td>
                                </tr>
                            </table>
                        </td>
                    </tr>
                </table>
            </td>
        </tr>

        <!-- Tagline -->
        <tr>
            <td style="padding: 0 40px 40px 40px;">
                <div style="border-top: 2px solid #000000; border-bottom: 2px solid #000000; padding: 30px 0;">
                    <div style="font-family: 'Assistant', Arial, sans-serif; font-weight: 500; font-size: 18px; line-height: 1.5; letter-spacing: 5px; text-transform: uppercase; color: #000000; text-align: center;">
                        DARE TO THINK Â· COMMIT TO DELIVER
                    </div>
                </div>
            </td>
        </tr>

    </table>

    <script>
        // Get URL parameters
        const urlParams = new URLSearchParams(window.location.search);
        const clientId = urlParams.get('client_id');
        const totalAmount = urlParams.get('amount');
        const companyName = urlParams.get('company_name') || '××¡×¢×“×ª ×”××—×™×';
        const groupName = urlParams.get('group_name') || '×§×‘×•×¦×ª ××¡×¢×“×•×ª ×™×©×¨××œ×™×•×ª';
        const numChecks = parseInt(urlParams.get('num_checks')) || 8; // Dynamic: 8 or 12

        // Calculate check amount (total Ã· numChecks)
        let checkAmount = 5900; // Default
        let formattedCheckAmount = '5,900';
        let formattedTotalAmount = '47,200';

        if (totalAmount) {
            // Remove commas and parse
            const cleanAmount = parseFloat(totalAmount.replace(/,/g, ''));
            if (!isNaN(cleanAmount)) {
                checkAmount = Math.round(cleanAmount / numChecks);
                formattedCheckAmount = checkAmount.toLocaleString('he-IL');
                formattedTotalAmount = cleanAmount.toLocaleString('he-IL');
            }
        }

        // Update page content dynamically
        document.addEventListener('DOMContentLoaded', function() {
            // Update page title (browser tab)
            document.getElementById('page-title').textContent = `×¤×¨×˜×™ ×ª×©×œ×•× ×‘-${numChecks} ×”××—××•×ª - ${companyName}`;

            // Update main title (in page)
            document.getElementById('main-title').textContent = `×¤×¨×˜×™ ×ª×©×œ×•× ×‘-${numChecks} ×”××—××•×ª`;

            // Update company name
            const companyElements = document.querySelectorAll('.company-name');
            companyElements.forEach(el => {
                el.innerHTML = `${companyName}<br>${groupName}`;
            });

            // Update all check amounts
            const checkAmountElements = document.querySelectorAll('.check-amount');
            checkAmountElements.forEach(el => {
                el.textContent = `â‚ª${formattedCheckAmount}`;
            });

            // Update total amount
            const totalAmountElements = document.querySelectorAll('.total-amount');
            totalAmountElements.forEach(el => {
                el.textContent = `â‚ª${formattedTotalAmount}`;
            });

            // Update description text
            const descriptionElement = document.querySelector('.check-description');
            if (descriptionElement) {
                descriptionElement.innerHTML = `× ×•×“×”, ××™×¤×”, ×¢×œ ×”×›× ×ª ${numChecks} ×”××—××•×ª ×©×¡×›×•× ×›×œ ××—×ª ××”×Ÿ (×”×¡×›×•× ×›×‘×¨ ×›×•×œ×œ ××¢"×) ×”×™× ×• ×‘×¡×”"×› ×©×œ: <span style="text-decoration: underline; font-weight: 600;">â‚ª${formattedCheckAmount}</span>.`;
            }

            // Update calculation text
            const calculationElement = document.querySelector('.check-calculation');
            if (calculationElement) {
                calculationElement.innerHTML = `<strong>×¡×›×•× ×›×•×œ×œ ×œ×ª×©×œ×•×: â‚ª${formattedTotalAmount}</strong> (${numChecks} ×”××—××•×ª Ã— â‚ª${formattedCheckAmount})`;
            }

            // REBUILD TABLE DYNAMICALLY based on numChecks
            rebuildCheckTable();
        });

        // Rebuild the check table with correct number of rows
        function rebuildCheckTable() {
            // Find the check schedule table (the one with border and inside the check schedule section)
            const tables = document.querySelectorAll('table');
            let checkTable = null;

            // Find the table that contains the header row with "××¡×¤×¨ ×”××—××”"
            for (const table of tables) {
                const headerCells = table.querySelectorAll('th');
                for (const th of headerCells) {
                    if (th.textContent.includes('××¡×¤×¨ ×”××—××”')) {
                        checkTable = table;
                        break;
                    }
                }
                if (checkTable) break;
            }

            if (!checkTable) return;

            // Get all rows in the table
            const rows = Array.from(checkTable.querySelectorAll('tr'));

            // Keep only the header row (first row with <th> elements)
            // Remove all data rows (rows 1-9: checks 1-8 + total row)
            for (let i = rows.length - 1; i >= 1; i--) {
                rows[i].remove();
            }

            // Generate new rows for numChecks
            const currentYear = new Date().getFullYear();
            const taxYear = currentYear + 1; // 2026 for 2025

            for (let i = 1; i <= numChecks; i++) {
                const month = i;
                const date = `5.${month}.${taxYear}`;
                const isLast = (i === numChecks);

                const row = document.createElement('tr');
                row.innerHTML = `
                    <td style="padding: 10px 12px; text-align: right; font-size: 13px; color: hsl(222.2 84% 4.9%); ${!isLast ? 'border-bottom: 1px solid hsl(214.3 31.8% 91.4%);' : ''}">${i}</td>
                    <td style="padding: 10px 12px; text-align: right; font-size: 13px; color: hsl(222.2 84% 4.9%); ${!isLast ? 'border-bottom: 1px solid hsl(214.3 31.8% 91.4%);' : ''}">${date}</td>
                    <td class="check-amount" style="padding: 10px 12px; text-align: right; font-size: 13px; font-weight: 600; color: hsl(222.2 84% 4.9%); ${!isLast ? 'border-bottom: 1px solid hsl(214.3 31.8% 91.4%);' : ''}">â‚ª${formattedCheckAmount}</td>
                `;
                checkTable.appendChild(row);
            }

            // Add total row
            const totalRow = document.createElement('tr');
            totalRow.style.backgroundColor = 'hsl(210 40% 96.1%)';
            totalRow.innerHTML = `
                <td colspan="2" style="padding: 12px; text-align: right; font-size: 14px; font-weight: 600; color: hsl(222.2 84% 4.9%); border-top: 2px solid hsl(214.3 31.8% 91.4%);">×¡×”"×› ×œ×ª×©×œ×•×:</td>
                <td class="total-amount" style="padding: 12px; text-align: right; font-size: 14px; font-weight: 700; color: hsl(222.2 84% 4.9%); border-top: 2px solid hsl(214.3 31.8% 91.4%);">â‚ª${formattedTotalAmount}</td>
            `;
            checkTable.appendChild(totalRow);
        }

        // Track check details view
        if (clientId) {
            console.log(`Payment method selected: ${numChecks} Checks`);
            console.log('Client ID:', clientId);
            console.log('Total Amount:', totalAmount);
            console.log('Check Amount:', formattedCheckAmount);
            // Future: Send tracking event to API
        }
    </script>
</body>
</html>
