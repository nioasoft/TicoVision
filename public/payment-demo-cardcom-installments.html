<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>תשלום מאובטח - 4 תשלומים - Cardcom</title>
    <link href="https://fonts.googleapis.com/css2?family=Assistant:wght@400;500;600;700&family=Heebo:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<body style="margin: 0; padding: 20px; font-family: 'Assistant', 'Heebo', Arial, sans-serif; background-color: #f5f5f7; direction: rtl;">
    <!-- Demo banner (only for demo mode) -->
    <div style="background-color: #fff3cd; color: #856404; padding: 16px; text-align: center; font-weight: 600; border-radius: 8px; max-width: 700px; margin: 0 auto 20px auto;">
        🧪 <strong>מצב הדגמה:</strong> זהו עמוד דמו - לא יבוצע חיוב אמיתי. השתמש בכרטיס 4580-0000-0000-0000 לבדיקה.
    </div>

    <!-- Main container -->
    <table width="700" cellpadding="0" cellspacing="0" border="0" style="margin: 0 auto; background-color: #ffffff; border-radius: 8px; border: 1px solid #e4e4e7; box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);">

        <!-- Header: Cardcom logo & secure badge -->
        <tr>
            <td style="padding: 40px 40px 20px 40px;">
                <table width="100%" cellpadding="0" cellspacing="0" border="0">
                    <tr>
                        <td style="text-align: center;">
                            <div style="font-size: 24px; font-weight: 700; color: #09090b; margin-bottom: 8px;">
                                Cardcom
                            </div>
                            <div style="font-size: 14px; color: #71717a; display: inline-flex; align-items: center; gap: 6px; background-color: #f3f4f6; padding: 6px 14px; border-radius: 20px;">
                                🔒 תשלום מאובטח SSL
                            </div>
                        </td>
                    </tr>
                </table>
            </td>
        </tr>

        <!-- Border -->
        <tr>
            <td style="padding: 0 40px 30px 40px;">
                <div style="border-top: 1px solid #e4e4e7;"></div>
            </td>
        </tr>

        <!-- Amount box -->
        <tr>
            <td style="padding: 0 40px 30px 40px;">
                <div style="background-color: #f3f4f6; border-radius: 8px; padding: 24px; text-align: center;">
                    <div style="font-size: 18px; font-weight: 600; color: #09090b; margin-bottom: 12px;">
                        פרנקו ושות' רו"ח
                    </div>
                    <div style="font-size: 16px; color: #71717a; margin-bottom: 8px;">
                        סכום כולל לתשלום:
                    </div>
                    <div style="font-size: 36px; font-weight: 700; color: #09090b;">
                        ₪<span id="amount">49,920</span>
                    </div>
                    <div style="font-size: 15px; color: #71717a; margin-top: 8px;">
                        ב-<span id="installments">4</span> תשלומים של ₪<span id="perInstallment">12,480</span>
                    </div>
                    <div id="discountBadge" style="display: inline-block; background-color: #e0e7ff; color: #3730a3; padding: 4px 12px; border-radius: 6px; font-size: 13px; font-weight: 600; margin-top: 12px;">
                        💰 הנחה של 4% - חיסכון ₪2,080
                    </div>
                </div>
            </td>
        </tr>

        <!-- Form -->
        <tr>
            <td style="padding: 0 40px 30px 40px;">
                <form id="cardForm">
                    <!-- Card number -->
                    <div style="margin-bottom: 20px;">
                        <label style="display: block; font-size: 15px; font-weight: 600; color: #09090b; margin-bottom: 8px; text-align: right;">
                            מספר כרטיס אשראי
                        </label>
                        <input type="text" id="cardNumber" placeholder="4580-0000-0000-0000" maxlength="19" required style="width: 100%; padding: 14px; border: 2px solid #e4e4e7; border-radius: 6px; font-size: 16px; font-family: 'Assistant', Arial, sans-serif; direction: ltr; text-align: left; box-sizing: border-box;">
                        <div style="display: flex; gap: 8px; margin-top: 10px;">
                            <div style="padding: 4px 10px; background-color: #f3f4f6; border: 1px solid #e4e4e7; border-radius: 4px; font-size: 11px; font-weight: 600; color: #71717a;">VISA</div>
                            <div style="padding: 4px 10px; background-color: #f3f4f6; border: 1px solid #e4e4e7; border-radius: 4px; font-size: 11px; font-weight: 600; color: #71717a;">MC</div>
                            <div style="padding: 4px 10px; background-color: #f3f4f6; border: 1px solid #e4e4e7; border-radius: 4px; font-size: 11px; font-weight: 600; color: #71717a;">AMEX</div>
                            <div style="padding: 4px 10px; background-color: #f3f4f6; border: 1px solid #e4e4e7; border-radius: 4px; font-size: 11px; font-weight: 600; color: #71717a;">DINERS</div>
                        </div>
                    </div>

                    <!-- Expiry & CVV -->
                    <table width="100%" cellpadding="0" cellspacing="0" border="0" style="margin-bottom: 20px;">
                        <tr>
                            <td width="48%" style="vertical-align: top;">
                                <label style="display: block; font-size: 15px; font-weight: 600; color: #09090b; margin-bottom: 8px; text-align: right;">
                                    תוקף (MM/YY)
                                </label>
                                <input type="text" id="expiry" placeholder="12/26" maxlength="5" required style="width: 100%; padding: 14px; border: 2px solid #e4e4e7; border-radius: 6px; font-size: 16px; font-family: 'Assistant', Arial, sans-serif; direction: ltr; text-align: left; box-sizing: border-box;">
                            </td>
                            <td width="4%"></td>
                            <td width="48%" style="vertical-align: top;">
                                <label style="display: block; font-size: 15px; font-weight: 600; color: #09090b; margin-bottom: 8px; text-align: right;">
                                    CVV
                                </label>
                                <input type="text" id="cvv" placeholder="123" maxlength="4" required style="width: 100%; padding: 14px; border: 2px solid #e4e4e7; border-radius: 6px; font-size: 16px; font-family: 'Assistant', Arial, sans-serif; direction: ltr; text-align: left; box-sizing: border-box;">
                            </td>
                        </tr>
                    </table>

                    <!-- Cardholder name -->
                    <div style="margin-bottom: 20px;">
                        <label style="display: block; font-size: 15px; font-weight: 600; color: #09090b; margin-bottom: 8px; text-align: right;">
                            שם בעל הכרטיס
                        </label>
                        <input type="text" id="cardholderName" placeholder="SARAH LEVI" required style="width: 100%; padding: 14px; border: 2px solid #e4e4e7; border-radius: 6px; font-size: 16px; font-family: 'Assistant', Arial, sans-serif; direction: ltr; text-align: left; box-sizing: border-box;">
                    </div>

                    <!-- ID number -->
                    <div style="margin-bottom: 30px;">
                        <label style="display: block; font-size: 15px; font-weight: 600; color: #09090b; margin-bottom: 8px; text-align: right;">
                            מספר תעודת זהות
                        </label>
                        <input type="text" id="idNumber" placeholder="123456789" maxlength="9" required style="width: 100%; padding: 14px; border: 2px solid #e4e4e7; border-radius: 6px; font-size: 16px; font-family: 'Assistant', Arial, sans-serif; direction: ltr; text-align: left; box-sizing: border-box;">
                    </div>

                    <!-- Submit button -->
                    <div style="text-align: center;">
                        <button type="submit" style="width: 100%; background-color: #09090b; color: #ffffff; padding: 18px; border: none; border-radius: 6px; font-size: 18px; font-weight: 700; cursor: pointer; font-family: 'Assistant', 'Heebo', Arial, sans-serif; transition: opacity 0.2s;">
                            💳 שלם עכשיו ₪<span id="buttonAmount">49,920</span>
                        </button>
                    </div>

                    <!-- Security note -->
                    <div style="text-align: center; color: #71717a; font-size: 13px; margin-top: 20px; line-height: 1.6;">
                        🔒 התשלום מאובטח ומוצפן ב-SSL 256-bit<br>
                        המידע שלך מוגן על ידי Cardcom
                    </div>
                </form>
            </td>
        </tr>

        <!-- Success message (hidden initially) -->
        <tr id="successSection" style="display: none;">
            <td style="padding: 0 40px 40px 40px;">
                <div style="background-color: #f3f4f6; border: 2px solid #09090b; padding: 32px; border-radius: 8px; text-align: center;">
                    <div style="font-size: 64px; margin-bottom: 20px;">✅</div>
                    <div style="font-size: 24px; font-weight: 700; color: #09090b; margin-bottom: 12px;">
                        התשלום בוצע בהצלחה!
                    </div>
                    <div style="font-size: 16px; color: #09090b; line-height: 1.8;">
                        <p><strong>מספר אישור:</strong> <span id="approvalNumber"></span></p>
                        <p><strong>תאריך:</strong> <span id="paymentDate"></span></p>
                        <p><strong>סכום:</strong> ₪<span id="paidAmount"></span></p>
                        <p><strong>תשלומים:</strong> <span id="installmentsConfirm"></span> תשלומים</p>
                        <br>
                        <p style="color: #09090b;">🎉 קבלה נשלחה למייל</p>
                        <p style="margin-top: 20px; font-size: 13px; color: #71717a;">
                            <em>* זהו דף דמו - לא בוצע חיוב אמיתי</em>
                        </p>
                    </div>
                </div>
            </td>
        </tr>

        <!-- Footer -->
        <tr>
            <td style="padding: 30px 40px; background-color: #fafafa; border-top: 1px solid #e4e4e7;">
                <div style="font-size: 13px; color: #71717a; text-align: center; line-height: 1.6;">
                    Powered by Cardcom | מאובטח על ידי בנק ישראל
                </div>
            </td>
        </tr>

    </table>

    <script>
        // Get amount and installments from URL
        const urlParams = new URLSearchParams(window.location.search);
        const amount = urlParams.get('amount') || '49,920';
        const installments = urlParams.get('installments') || '4';
        const perInstallment = urlParams.get('per_installment') || '12,480';
        const clientId = urlParams.get('client_id') || 'DEMO-2025-001';

        // Update amount displays
        document.getElementById('amount').textContent = amount;
        document.getElementById('buttonAmount').textContent = amount;
        document.getElementById('installments').textContent = installments;
        document.getElementById('perInstallment').textContent = perInstallment;

        // Format card number with dashes
        document.getElementById('cardNumber').addEventListener('input', function(e) {
            let value = e.target.value.replace(/\s/g, '').replace(/-/g, '').replace(/[^0-9]/g, '');
            e.target.value = value.match(/.{1,4}/g)?.join('-') || value;
        });

        // Format expiry date
        document.getElementById('expiry').addEventListener('input', function(e) {
            let value = e.target.value.replace(/\D/g, '');
            if (value.length >= 2) {
                value = value.substring(0, 2) + '/' + value.substring(2, 4);
            }
            e.target.value = value;
        });

        // Only allow numbers in CVV
        document.getElementById('cvv').addEventListener('input', function(e) {
            e.target.value = e.target.value.replace(/[^0-9]/g, '');
        });

        // Only allow numbers in ID
        document.getElementById('idNumber').addEventListener('input', function(e) {
            e.target.value = e.target.value.replace(/[^0-9]/g, '');
        });

        // Handle form submission
        document.getElementById('cardForm').addEventListener('submit', function(e) {
            e.preventDefault();

            // Hide form
            document.getElementById('cardForm').style.display = 'none';
            document.querySelector('form').parentElement.parentElement.style.display = 'none';

            // Show success message
            document.getElementById('successSection').style.display = 'table-row';

            // Generate random approval number
            const approvalNumber = Math.floor(100000 + Math.random() * 900000);
            document.getElementById('approvalNumber').textContent = approvalNumber;

            // Set payment date and time
            const now = new Date();
            document.getElementById('paymentDate').textContent = now.toLocaleDateString('he-IL') + ' ' + now.toLocaleTimeString('he-IL');
            document.getElementById('paidAmount').textContent = amount;
            document.getElementById('installmentsConfirm').textContent = installments;

            // Redirect after 3 seconds
            setTimeout(function() {
                window.location.href = '/payment/success?client_id=' + clientId + '&amount=' + amount + '&approval=' + approvalNumber + '&installments=' + installments;
            }, 3000);
        });

        // Add hover effect to button
        const button = document.querySelector('button[type="submit"]');
        button.addEventListener('mouseenter', function() {
            this.style.opacity = '0.9';
        });
        button.addEventListener('mouseleave', function() {
            this.style.opacity = '1';
        });
    </script>
</body>
</html>
